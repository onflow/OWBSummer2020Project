{"ast":null,"code":"import _slicedToArray from \"@babel/runtime/helpers/esm/slicedToArray\";\nimport _defineProperty from \"@babel/runtime/helpers/esm/defineProperty\";\nimport _styled from \"@emotion/styled-base\";\nvar _jsxFileName = \"/Users/lukehamilton/development/lyra-labs-dev/lyra-labs/frontend/shared/library/components/buttons/follow/index.js\";\nvar __jsx = React.createElement;\n\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(Object(source), true).forEach(function (key) { _defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }\n\nimport React, { useContext } from \"react\";\nimport { useMutation } from \"@apollo/react-hooks\";\nimport { CurrentUserContext } from \"@enhancers/current-user\";\nimport { LoginModalContext } from \"@enhancers/login-modal\";\nimport { UPDATE_FOLLOWED_TOPIC } from \"@data/mutations\";\nimport { CURRENT_USER_QUERY } from \"@data/queries\";\nimport { WHITE, FOCUS_LAVENDER, PURPLE } from \"@style/colors\";\nimport { BASE_TEXT, WEIGHT } from \"@style/typography\";\n\nvar Container =\n/*#__PURE__*/\n_styled(\"div\", {\n  target: \"elejpoc0\",\n  label: \"Container\"\n})(_objectSpread({}, BASE_TEXT, {\n  fontWeight: WEIGHT.BOLD,\n  textTransform: \"uppercase\",\n  backgroundColor: PURPLE,\n  color: WHITE,\n  borderRadius: 3,\n  padding: \"2px 8px\",\n  \"&:hover\": {\n    backgroundColor: FOCUS_LAVENDER\n  }\n}), false ? \"\" : \"/*# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi9Vc2Vycy9sdWtlaGFtaWx0b24vZGV2ZWxvcG1lbnQvbHlyYS1sYWJzLWRldi9seXJhLWxhYnMvZnJvbnRlbmQvc2hhcmVkL2xpYnJhcnkvY29tcG9uZW50cy9idXR0b25zL2ZvbGxvdy9pbmRleC5qcyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFZa0IiLCJmaWxlIjoiL1VzZXJzL2x1a2VoYW1pbHRvbi9kZXZlbG9wbWVudC9seXJhLWxhYnMtZGV2L2x5cmEtbGFicy9mcm9udGVuZC9zaGFyZWQvbGlicmFyeS9jb21wb25lbnRzL2J1dHRvbnMvZm9sbG93L2luZGV4LmpzIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IFJlYWN0LCB7IHVzZUNvbnRleHQgfSBmcm9tIFwicmVhY3RcIjtcbmltcG9ydCBzdHlsZWQgZnJvbSBcIkBlbW90aW9uL3N0eWxlZFwiO1xuaW1wb3J0IHsgdXNlTXV0YXRpb24gfSBmcm9tIFwiQGFwb2xsby9yZWFjdC1ob29rc1wiO1xuaW1wb3J0IHsgQ3VycmVudFVzZXJDb250ZXh0IH0gZnJvbSBcIkBlbmhhbmNlcnMvY3VycmVudC11c2VyXCI7XG5pbXBvcnQgeyBMb2dpbk1vZGFsQ29udGV4dCB9IGZyb20gXCJAZW5oYW5jZXJzL2xvZ2luLW1vZGFsXCI7XG5cbmltcG9ydCB7IFVQREFURV9GT0xMT1dFRF9UT1BJQyB9IGZyb20gXCJAZGF0YS9tdXRhdGlvbnNcIjtcbmltcG9ydCB7IENVUlJFTlRfVVNFUl9RVUVSWSB9IGZyb20gXCJAZGF0YS9xdWVyaWVzXCI7XG5cbmltcG9ydCB7IFdISVRFLCBGT0NVU19MQVZFTkRFUiwgUFVSUExFIH0gZnJvbSBcIkBzdHlsZS9jb2xvcnNcIjtcbmltcG9ydCB7IEJBU0VfVEVYVCwgV0VJR0hUIH0gZnJvbSBcIkBzdHlsZS90eXBvZ3JhcGh5XCI7XG5cbmNvbnN0IENvbnRhaW5lciA9IHN0eWxlZChcImRpdlwiKSh7XG4gIC4uLkJBU0VfVEVYVCxcbiAgZm9udFdlaWdodDogV0VJR0hULkJPTEQsXG4gIHRleHRUcmFuc2Zvcm06IFwidXBwZXJjYXNlXCIsXG4gIGJhY2tncm91bmRDb2xvcjogUFVSUExFLFxuICBjb2xvcjogV0hJVEUsXG4gIGJvcmRlclJhZGl1czogMyxcbiAgcGFkZGluZzogXCIycHggOHB4XCIsXG4gIFwiJjpob3ZlclwiOiB7XG4gICAgYmFja2dyb3VuZENvbG9yOiBGT0NVU19MQVZFTkRFUlxuICB9XG59KTtcblxuY29uc3QgRm9sbG93QnV0dG9uID0gKHsgdG9waWNJZCB9KSA9PiB7XG4gIGNvbnN0IHNob3dMb2dpbiA9IHVzZUNvbnRleHQoTG9naW5Nb2RhbENvbnRleHQpO1xuICBjb25zdCBjdXJyZW50VXNlciA9IHVzZUNvbnRleHQoQ3VycmVudFVzZXJDb250ZXh0KTtcbiAgY29uc3QgW3VwZGF0ZUZvbGxvd2VkVG9waWMsIHsgZGF0YSB9XSA9IHVzZU11dGF0aW9uKFVQREFURV9GT0xMT1dFRF9UT1BJQywge1xuICAgIHVwZGF0ZTogKGNhY2hlLCB7IGRhdGE6IHsgdXBkYXRlRm9sbG93ZWRUb3BpYyB9IH0pID0+IHtcbiAgICAgIGNvbnN0IHVzZXIgPSBjYWNoZS5yZWFkUXVlcnkoeyBxdWVyeTogQ1VSUkVOVF9VU0VSX1FVRVJZIH0pO1xuICAgICAgY29uc3QgeyBmb2xsb3dlZFRvcGljcyB9ID0gdXNlci5tZTtcbiAgICAgIGxldCB1cGRhdGVkVG9waWNzO1xuICAgICAgaWYgKGZvbGxvd2luZykge1xuICAgICAgICB1cGRhdGVkVG9waWNzID0gZm9sbG93ZWRUb3BpY3MuZmlsdGVyKHRvcGljID0+IHRvcGljLmlkICE9PSB0b3BpY0lkKTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIGZvbGxvd2VkVG9waWNzLnB1c2godXBkYXRlRm9sbG93ZWRUb3BpYyk7XG4gICAgICAgIHVwZGF0ZWRUb3BpY3MgPSBmb2xsb3dlZFRvcGljcztcbiAgICAgIH1cbiAgICAgIHVzZXIubWUuZm9sbG93ZWRUb3BpY3MgPSB1cGRhdGVkVG9waWNzO1xuICAgICAgY2FjaGUud3JpdGVRdWVyeSh7IHF1ZXJ5OiBDVVJSRU5UX1VTRVJfUVVFUlksIGRhdGE6IHVzZXIgfSk7XG4gICAgfVxuICB9KTtcbiAgY29uc3QgZm9sbG93aW5nID0gY3VycmVudFVzZXJcbiAgICA/IGN1cnJlbnRVc2VyLmZvbGxvd2VkVG9waWNzLm1hcCh0b3BpYyA9PiB0b3BpYy5pZCkuaW5jbHVkZXModG9waWNJZClcbiAgICA6IGZhbHNlO1xuICBjb25zdCB0ZXh0ID0gZm9sbG93aW5nID8gXCLinJMgRk9MTE9XSU5HXCIgOiBcIisgRk9MTE9XXCI7XG5cbiAgY29uc3QgaGFuZGxlQ2xpY2sgPSBlID0+IHtcbiAgICBpZiAoY3VycmVudFVzZXIpIHtcbiAgICAgIGUucHJldmVudERlZmF1bHQoKTtcbiAgICAgIHVwZGF0ZUZvbGxvd2VkVG9waWMoe1xuICAgICAgICB2YXJpYWJsZXM6IHtcbiAgICAgICAgICB1c2VySWQ6IGN1cnJlbnRVc2VyLmlkLFxuICAgICAgICAgIHRvcGljSWQsXG4gICAgICAgICAgZm9sbG93aW5nOiB0cnVlXG4gICAgICAgIH1cbiAgICAgIH0pO1xuICAgIH0gZWxzZSB7XG4gICAgICBzaG93TG9naW4oKTtcbiAgICB9XG4gIH07XG5cbiAgcmV0dXJuIDxDb250YWluZXIgb25DbGljaz17aGFuZGxlQ2xpY2t9Pnt0ZXh0fTwvQ29udGFpbmVyPjtcbn07XG5cbmV4cG9ydCBkZWZhdWx0IEZvbGxvd0J1dHRvbjtcbiJdfQ== */\");\n\nvar FollowButton = function FollowButton(_ref) {\n  var topicId = _ref.topicId;\n  var showLogin = useContext(LoginModalContext);\n  var currentUser = useContext(CurrentUserContext);\n\n  var _useMutation = useMutation(UPDATE_FOLLOWED_TOPIC, {\n    update: function update(cache, _ref2) {\n      var updateFollowedTopic = _ref2.data.updateFollowedTopic;\n      var user = cache.readQuery({\n        query: CURRENT_USER_QUERY\n      });\n      var followedTopics = user.me.followedTopics;\n      var updatedTopics;\n\n      if (following) {\n        updatedTopics = followedTopics.filter(function (topic) {\n          return topic.id !== topicId;\n        });\n      } else {\n        followedTopics.push(updateFollowedTopic);\n        updatedTopics = followedTopics;\n      }\n\n      user.me.followedTopics = updatedTopics;\n      cache.writeQuery({\n        query: CURRENT_USER_QUERY,\n        data: user\n      });\n    }\n  }),\n      _useMutation2 = _slicedToArray(_useMutation, 2),\n      updateFollowedTopic = _useMutation2[0],\n      data = _useMutation2[1].data;\n\n  var following = currentUser ? currentUser.followedTopics.map(function (topic) {\n    return topic.id;\n  }).includes(topicId) : false;\n  var text = following ? \"✓ FOLLOWING\" : \"+ FOLLOW\";\n\n  var handleClick = function handleClick(e) {\n    if (currentUser) {\n      e.preventDefault();\n      updateFollowedTopic({\n        variables: {\n          userId: currentUser.id,\n          topicId: topicId,\n          following: true\n        }\n      });\n    } else {\n      showLogin();\n    }\n  };\n\n  return __jsx(Container, {\n    onClick: handleClick,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 64\n    },\n    __self: this\n  }, text);\n};\n\nexport default FollowButton;","map":{"version":3,"sources":["/Users/lukehamilton/development/lyra-labs-dev/lyra-labs/frontend/shared/library/components/buttons/follow/index.js"],"names":["React","useContext","useMutation","CurrentUserContext","LoginModalContext","UPDATE_FOLLOWED_TOPIC","CURRENT_USER_QUERY","WHITE","FOCUS_LAVENDER","PURPLE","BASE_TEXT","WEIGHT","Container","fontWeight","BOLD","textTransform","backgroundColor","color","borderRadius","padding","FollowButton","topicId","showLogin","currentUser","update","cache","updateFollowedTopic","data","user","readQuery","query","followedTopics","me","updatedTopics","following","filter","topic","id","push","writeQuery","map","includes","text","handleClick","e","preventDefault","variables","userId"],"mappings":"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","sourcesContent":["import React, { useContext } from \"react\";\nimport styled from \"@emotion/styled\";\nimport { useMutation } from \"@apollo/react-hooks\";\nimport { CurrentUserContext } from \"@enhancers/current-user\";\nimport { LoginModalContext } from \"@enhancers/login-modal\";\n\nimport { UPDATE_FOLLOWED_TOPIC } from \"@data/mutations\";\nimport { CURRENT_USER_QUERY } from \"@data/queries\";\n\nimport { WHITE, FOCUS_LAVENDER, PURPLE } from \"@style/colors\";\nimport { BASE_TEXT, WEIGHT } from \"@style/typography\";\n\nconst Container = styled(\"div\")({\n  ...BASE_TEXT,\n  fontWeight: WEIGHT.BOLD,\n  textTransform: \"uppercase\",\n  backgroundColor: PURPLE,\n  color: WHITE,\n  borderRadius: 3,\n  padding: \"2px 8px\",\n  \"&:hover\": {\n    backgroundColor: FOCUS_LAVENDER\n  }\n});\n\nconst FollowButton = ({ topicId }) => {\n  const showLogin = useContext(LoginModalContext);\n  const currentUser = useContext(CurrentUserContext);\n  const [updateFollowedTopic, { data }] = useMutation(UPDATE_FOLLOWED_TOPIC, {\n    update: (cache, { data: { updateFollowedTopic } }) => {\n      const user = cache.readQuery({ query: CURRENT_USER_QUERY });\n      const { followedTopics } = user.me;\n      let updatedTopics;\n      if (following) {\n        updatedTopics = followedTopics.filter(topic => topic.id !== topicId);\n      } else {\n        followedTopics.push(updateFollowedTopic);\n        updatedTopics = followedTopics;\n      }\n      user.me.followedTopics = updatedTopics;\n      cache.writeQuery({ query: CURRENT_USER_QUERY, data: user });\n    }\n  });\n  const following = currentUser\n    ? currentUser.followedTopics.map(topic => topic.id).includes(topicId)\n    : false;\n  const text = following ? \"✓ FOLLOWING\" : \"+ FOLLOW\";\n\n  const handleClick = e => {\n    if (currentUser) {\n      e.preventDefault();\n      updateFollowedTopic({\n        variables: {\n          userId: currentUser.id,\n          topicId,\n          following: true\n        }\n      });\n    } else {\n      showLogin();\n    }\n  };\n\n  return <Container onClick={handleClick}>{text}</Container>;\n};\n\nexport default FollowButton;\n"]},"metadata":{},"sourceType":"module"}